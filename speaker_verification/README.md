# Speaker Verification
The speaker encoder encodes the speaker identity. We therefore assume that the embeddings generated by the encoder are "close" or "similar" to other embeddings from the same speaker.

To measure the quality of speaker adaptation, we can measure this similarity between embeddings generated from synthesized speech and ground truth utterances. If the system works well, the similarity of the synthesized audio should be highest when compared to the ground truth audio used to generate the corresponding speaker embedding.

## Setup
### 1: Generate synthesized audio TODO
We first have to synthesize audio using speaker embeddings generated from ground truth audio.

**Important**: The speakers used in these experiments should not be part of the TTS/Speaker encoder training corpus.

We assume that the following data has been setup in the `speaker_verification` directory (or somehwere else):
```
./ground_truth_audio/
    speaker_a/
        audio_1.wav
        audio_2.wav
        ...
    speaker_b/
    ...
    speaker_z/
```

```
./synthesized_audio/
    speaker_a/
        audio_1_utt_1.wav
        audio_1_utt_2.wav
        ...
        audio_1_utt_n.wav
        audio_2_utt_1.wav
        ...
    speaker_b/
    ...
    speaker_z/
```
### 2: Generate Speaker Embeddings
We now generate speaker embeddings for all audio and store to disk. Assuming the data described above is ready, running `gen_embeddings.py` yields:
```
./embeddings/
    ground_truth/
        speaker_a/
            audio_1.npy
            audio_2.npy
            ...
        speaker_b/
        ...
        speaker_z/
    synthesized/
        speaker_a/
            audio_1_utt_1.npy
            audio_1_utt_2.npy
            ...
        speaker_b/
        ...
        speaker_z/
```
### 3: Measure similarity
After calculating embeddings we can determine the cosine similarity between ground truth and synthetic embeddings. Running `measure_similarity` yields a `result.tsv` file where each line is described by
```
<ground_truth_audio_id>\t<ground_truth_speaker_id>\t<synth_audio_id>\t<synth_speaker_id>\t<similarity>
```
### 4: Classification and Result Interpretation
TODO